name: CI Pipeline Snyk

on:
  push:

jobs:
  build:
    runs-on: ubuntu-latest  # F체hre auf einem Ubuntu-L채ufer aus

    steps:
      - name: Checkout code
        uses: actions/checkout@v4  # Aktualisiere auf die neueste Version

      - name: Build Docker Image
        run: docker build -t my-app:latest .  # Baue das Docker-Image aus dem Dockerfile

      - name: Run Tests
        run: docker run --rm my-app:latest pytest  # F체hre die Tests im Docker-Container aus

      - name: Install Snyk CLI
        run: npm install -g snyk # Installiere Snyk CLI f체r den Sicherheitsscan

      - name: Snyk Security Scan
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}  # Verwende das Snyk-Token aus den GitHub-Secrets
        run: snyk test --docker my-app:latest  # Scanne das Docker-Image mit Snyk

#name: Example workflow for Docker using Snyk
#on: push
#jobs:
#  security:
#    runs-on: ubuntu-latest
#    steps:
#    - name: Run Snyk to check Docker image for vulnerabilities
#      uses: snyk/actions/docker@master
#      env:
#        SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
#      with:
#        image: your/image-to-test